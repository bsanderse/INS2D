M_list = [5 5 10 10 20 20 40 40 80 80];

%% timings below are when process_iteration_FOM = 0 

%% without pressure:
mos_nopres = [   0.789497494000000   1.457578482000000   1.017804350000000   0.615487542000000   0.634751199000000   0.664064033000000   0.738969450000000   0.991089512000000   0.804699482000000   0.757015500000000 ];
precompute_nopres =  [   0.242185164000000   0.174849362000000   0.502604351000000   0.507245355000000   1.654134792000000   1.565873173000000   6.324379372000000   6.152124323000001  27.452874558000001  28.227834898000001];
time_loop_nopres = [   2.051287764000000   2.742492970000000   2.038488006000000   1.930893312000000   2.126032229999999   2.220494004000000   2.523691538000000   2.410432033000000   3.569588983000003  4.504532788000002];

%% with pressure: 
mos = [0.954628186000000   0.972480676000000   1.619674160000000   1.729555644000000   2.016215230000000   1.575889388000000  1.990733722000000   1.561708579000000   1.729556408000000   1.832783626000000 ];
precompute =  [  0.442073633000000   0.353959254000000   1.008499312000000   1.086062493000000   3.543486707000000   3.581513605000000  13.707578506000001  12.736451710000001  54.801640738000003  53.958134182000002];
time_loop = [    2.174605200000000   2.583834849000000   2.376993694000000   2.598533262000000   2.737489879000000   2.424230107000001 2.848159664000001   3.128091621999999   4.368026982000003   4.976104842000005];

%% FOM has been run 3 times:
fom = [73.664876351999993; 76.077162514999998; 81.306319036999994];


%% make figures
avg =@(list) 0.5*(list(1:2:end) + list(2:2:end));

figure
set(gca,'LineWidth',1);
M_plot = M_list(1:2:end);
mos_plot = avg(mos);

precompute_plot = avg(precompute);

time_plot = avg(time_loop);

loglog(M_plot,mos_plot,'s-','LineWidth',2);
hold on
loglog(M_plot,precompute_plot,'s-','LineWidth',2);
loglog(M_plot,time_plot,'s-','LineWidth',2);
loglog([2;100],[mean(fom);mean(fom)],'--','LineWidth',2);

grid
legend('Offline - MOS','Offline - Precomputing operators','Online','FOM','Location','west');
xlabel('M');
ylabel('CPU time [s]');
xlim([2 100]);
set(gca,'FontSize',14);

%%
export_fig('CPUtimings_actuator_unsteady','-pdf','-transparent')
