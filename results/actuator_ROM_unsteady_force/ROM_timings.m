M_list = [2 2 5 5 10 10 20 20 40 40 80 80];

%% timings below are when process_iteration_FOM = 0 

%% without pressure, with SVD
svd_nopres = [2.861947081000000   2.907536371000000   2.934558080000000    2.933950851000000   3.365919886000000   3.139761307000000   3.128492520000000   2.892918446000000   2.879845452000000   3.004153904000000   2.855391051000000    2.791039472000000];
precompute_nopres = [  0.069837427000000   0.069749063000000   0.173855507000000   0.192267286000000   0.484658480000000   0.482168274000000   1.578391402999999   1.567560375000000   6.414063443000001   5.924920761999999  25.225484321000000   25.173831792000001];
time_loop_nopres = [ 0.277565087000000   0.263765188000000   0.260369851000000   0.285967214000000   0.267576822000000   0.269539556000000   0.300382368999999   0.331764773000000   0.382258041000000   0.318293484000000   0.704096223000001   0.697333686000000];

%% with pressure, with SVD
svd = [ 6.890362058000000   5.568564760999999   5.031946200000000   4.851888822999999   5.699719923000000   4.859272664000001   4.764570266000001   4.758878149999999   4.801605854000000   4.766893679000000   4.832556534000000  5.747319033000001];
precompute = [ 0.157249608000000   0.224717226000000   0.497649411999999   0.387831691000000   1.161274495000001   1.153532012000000   3.609373947000001   3.381604155000001  12.830100721000001  12.941095382000000  55.431526390999998  58.494017837999991];
time_loop = [ 0.435861131000000   0.371995610000000   0.348949934000000   0.390405983000001   0.458212253000000   0.394398056000000   0.453798962000000   0.453763937000000   0.622634703999999   0.568742315999998   1.301036709000002   1.584805024000005];

% %% without pressure:
% mos_nopres = [   0.789497494000000   1.457578482000000   1.017804350000000   0.615487542000000   0.634751199000000   0.664064033000000   0.738969450000000   0.991089512000000   0.804699482000000   0.757015500000000 ];
% precompute_nopres =  [   0.242185164000000   0.174849362000000   0.502604351000000   0.507245355000000   1.654134792000000   1.565873173000000   6.324379372000000   6.152124323000001  27.452874558000001  28.227834898000001];
% time_loop_nopres = [   2.051287764000000   2.742492970000000   2.038488006000000   1.930893312000000   2.126032229999999   2.220494004000000   2.523691538000000   2.410432033000000   3.569588983000003  4.504532788000002];
% 
% %% with pressure: 
% mos = [0.954628186000000   0.972480676000000   1.619674160000000   1.729555644000000   2.016215230000000   1.575889388000000  1.990733722000000   1.561708579000000   1.729556408000000   1.832783626000000 ];
% precompute =  [  0.442073633000000   0.353959254000000   1.008499312000000   1.086062493000000   3.543486707000000   3.581513605000000  13.707578506000001  12.736451710000001  54.801640738000003  53.958134182000002];
% time_loop = [    2.174605200000000   2.583834849000000   2.376993694000000   2.598533262000000   2.737489879000000   2.424230107000001 2.848159664000001   3.128091621999999   4.368026982000003   4.976104842000005];

%% FOM has been run 3 times:
fom = [73.664876351999993; 76.077162514999998; 81.306319036999994];


%% make figures
avg =@(list) 0.5*(list(1:2:end) + list(2:2:end));

figure
set(gca,'LineWidth',1);
M_plot = M_list(1:2:end);
svd_plot        = avg(svd);
precompute_plot = avg(precompute);
time_plot       = avg(time_loop);
svd_nopres_plot        = avg(svd_nopres);
precompute_nopres_plot = avg(precompute_nopres);
time_nopres_plot       = avg(time_loop_nopres);

loglog(M_plot,svd_nopres_plot,'s-','LineWidth',2);
hold on
loglog(M_plot,svd_plot,'s-','LineWidth',2);

loglog(M_plot,precompute_nopres_plot,'s-','LineWidth',2);
loglog(M_plot,precompute_plot,'s-','LineWidth',2);

loglog(M_plot,time_nopres_plot,'s-','LineWidth',2);
loglog(M_plot,time_plot,'s-','LineWidth',2);
loglog([1;100],[mean(fom);mean(fom)],'--','LineWidth',2);

grid
legend('Offline - SVD','Offline - Precomputing operators','Online','FOM','Location','west');
xlabel('M');
ylabel('CPU time [s]');
xlim([2 100]);
set(gca,'FontSize',14);

%%
export_fig('CPUtimings_actuator_unsteady','-pdf','-transparent')
