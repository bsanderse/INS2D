M_list = [2 2 5 5 10 10 20 20 40 40];


%% run 4/5/2020
% with pressure recovery:
% SVD used for basis
svd_pr = [4.194441659000002   4.168076094000000   4.296831313999999   3.731857524000000   3.798401864000000   3.705872598999999   4.071108674000000   3.855432874000000   3.722242456000000    3.598327982000001];
precompute_pr = [0.259829200000000   0.119702168000000   0.276180349000000   0.255219438000000   0.730017224000000   0.638851418000000   2.269844881999999   1.997207946000000   7.194899527000000   7.279754182000000];
time_loop_pr = [0.751518695000000   0.597188070000001   0.447264308000000   0.501309866000000   0.461241851000000   0.425922249000000   0.457138358000000   0.471429710000000   0.610744009999999   0.593368557000000];

%% run 4/5/2020
% without pressure:
% SVD used for basis
svd = [2.593190006000000   2.522591795000000   2.648668109000000   2.486375477000000   2.475196492000000   2.485499114000000   2.573551143000000   2.468105839000000   2.481250874000000   2.458341696000000];
precompute = [0.047571782000000   0.053961092000000   0.126562755000000   0.118620308000000   0.317435837000000   0.330898777000000   1.063022996000000   1.068306627000000   3.802596991000000     3.929998962000000];
time_loop = [0.358697396000000   0.472808422000000   0.374729325000000   0.395391078000000   0.366510880000000   0.362734182000000   0.491899623000001   0.399933151000000   0.433787943000000   0.456288033000000];

%%
% svd = [2.097570026000000   2.016535143000000  2.143574014000000   2.278514066000000    2.143425340000000   2.125944484000000   2.363778017000000   2.202568823000000  2.275052980000000   2.034993899000000   3.564177940000000  2.047571665000000];
% 
% precompute = [0.105614838000000   0.096909677000000    0.223641159000000   0.241314174000000    0.547884989999999   0.559247430000000   1.834088597000000   1.771210199000000    6.873993122000000   6.802699946000000  32.835556760999999  30.200450748000002];
% 
% time_loop = [  1.793790876000000   1.712779085999999   1.791833831999999   1.750708259000000   1.815202627000001   1.812024081000001    1.859542138000000   1.867733788000001    2.117332157000000   2.635736772000000    3.907919168999996   3.958633169000002];

%% FOM has been run 3 times:
% results are for the time_loop
fom = [34.875072592999999 35.070824688999998 35.869518587000002];


avg =@(list) 0.5*(list(1:2:end) + list(2:2:end));

%% create figure
figure
set(gca,'LineWidth',1);
M_plot = M_list(1:2:end);
svd_plot        = avg(svd);
precompute_plot = avg(precompute);
time_plot       = avg(time_loop);
svd_pr_plot        = avg(svd_pr);
precompute_pr_plot = avg(precompute_pr);
time_pr_plot       = avg(time_loop_pr);



loglog(M_plot,svd_plot,'s-','LineWidth',2);
hold on
loglog(M_plot,svd_pr_plot,'s--','LineWidth',2);

loglog(M_plot,precompute_plot,'s-','LineWidth',2);
loglog(M_plot,precompute_pr_plot,'s--','LineWidth',2);

loglog(M_plot,time_plot,'s-','LineWidth',2);
loglog(M_plot,time_pr_plot,'s--','LineWidth',2);

loglog([1;100],[mean(fom);mean(fom)],'--','LineWidth',2);

grid
legend('Offline - SVD','Offline - Precomputing operators','Online','FOM','Location','west');
xlabel('M');
ylabel('CPU time [s]');
xlim([1 100]);
set(gca,'FontSize',14);

%%
export_fig('CPUtimings_LDC_unsteady','-pdf','-transparent')
