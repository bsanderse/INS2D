clear vars
M_list = [2 2 4 4 8 8 16 16 32 32];

%% old runs
% svd = [   1.838781550000000   1.845571699000000   1.865703083000000   1.783140290000000  1.740951802000000   1.815695423000001  1.900404364000000   1.855649407000000  1.749046473000000   1.983229209000000];
% 
% precompute =  [0.251733964000000   0.248007699000000    0.465944821000000   0.464967988000000   1.286483787000000   1.248063014000000   4.100600315000000   4.040544959999999   16.991264284000003  15.634421606000000];
% 
% time_loop =   [ 2.364090564000001   1.830272943000001    1.880433734000000   1.860130696000000   1.924760972000000   1.900528199999999    2.122761275000000   2.145150909000000   2.754535253000000   2.612073565000003];

%% runs May 13
% not processing at FOM level
% no pressure
% Implicit Midpoint:
% svd = [3.254172974000000   2.534318306000000   2.381451176000000   2.113554429000000   2.095026511000000   2.113865800000000   2.079131728000000   2.272380763000000   2.105283917000000   2.179313635000000];

% precompute = [0.171769185000000   0.127129048000000   0.248233279000000   0.269320606000000   0.703853313000000   0.647317319000000   2.107642521000000   2.141585453000000   8.390140990999999   7.999050295999999];

time_loop_IM = [0.462953482000000   0.419261673000000   0.361558879000000   0.373090204000000   0.398513029000000   0.377040558000000   0.407684099000000   0.421804411999999   0.470020559000000   0.476285187000000];



%% runs May 13
% not processing at FOM level
% no pressure
% RK4:
svd_RK = [2.512423235000000   2.357531365000000   2.049415920000000   2.172393723000000   2.054656805000000   2.066879975000000   2.076043374000000   2.096774317000000   2.931810705000000   2.102265284000000];

precompute_RK = [0.116783051000000   0.185611137000000   0.252142606000000   0.244443992000000   0.658531794000000   0.656269725000000   2.041736529000000   2.113778245999999   7.955644792999999   8.069275339000001];

time_loop_RK = [0.153853300000000   0.171666952000000   0.137716569000000   0.136604931000000   0.156439210000000   0.142713039000000   0.147569363000000   0.184008233000000   0.187559142000000   0.189635514999999];

%%
% FOM has been run 3 times:
% results are for the time_loop
fom = [     1.004640919380000e+02 1.082086400460000e+02   1.106526816070000e+02];


avg =@(list) 0.5*(list(1:2:end) + list(2:2:end));

figure
set(gca,'LineWidth',1);
M_plot = M_list(1:2:end);
svd_plot = avg(svd_RK);

precompute_plot = avg(precompute_RK);

time_plot_RK = avg(time_loop_RK);
time_plot_IM = avg(time_loop_IM);

loglog(M_plot,svd_plot,'s-','LineWidth',2);
hold on
loglog(M_plot,precompute_plot,'s-','LineWidth',2);
loglog(M_plot,time_plot_IM,'s-','LineWidth',2);
loglog(M_plot,time_plot_RK,'s--','LineWidth',2);

loglog([1;60],[mean(fom);mean(fom)],'-','LineWidth',2);

grid
legend('Offline - SVD','Offline - Precomputing operators','Online - Implicit','Online - Explicit','FOM','Location','southeast');
xlabel('M');
ylabel('CPU time [s]');
xlim([1 60]);
ylim([0.5e-1 3e2]);
set(gca,'FontSize',14);

a = get(gcf, 'CurrentAxes');
% get the handles for children of the axes -- these are the data series handles
c = get(a, 'Children')
colormap = get(gca,'ColorOrder');
set(c(2),'Color',colormap(3,:));
set(c(1),'Color',colormap(4,:));

%%
export_fig('CPUtimings_shearlayer_unsteady_IMvsRK','-pdf','-transparent')
