function [basis,weight_matrix] = Om_POD(snapshot_matrix,no_modes,options)
% POD basis with respect to the Omega_h weighted inner product

Om = options.grid.Om;
Om_sqrt = sqrt(Om);
Om_sqrt_inv = 1./Om_sqrt;

[basis,trunc_Sigma_sqrd] = Om_sqrt_inv.*POD(Om_sqrt.*snapshot_matrix,no_modes);

weight_matrix = snapshot_matrix

%testing
% basis'*(Om.*basis)

